<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IIMK Assignment 9.1 Submission</title>
  <style>
    body {
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      background: linear-gradient(135deg, #e3f0ff 0%, #b3d8ff 100%);
      margin: 0;
      color: #1a237e;
    }
    .container {
      max-width: 900px;
      margin: 40px auto 40px auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 24px rgba(30, 64, 175, 0.10);
      padding: 40px 32px 32px 32px;
      border: 1.5px solid #90caf9;
    }
    h1, h2, h3, h4 {
      color: #1976d2;
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      font-weight: 700;
    }
    h1 {
      font-size: 2.2em;
      border-bottom: 2px solid #1976d2;
      padding-bottom: 0.2em;
      margin-bottom: 0.7em;
    }
    h2 {
      font-size: 1.5em;
      border-left: 6px solid #64b5f6;
      padding-left: 12px;
      background: #e3f2fd;
      border-radius: 6px;
    }
    h3 {
      font-size: 1.2em;
      color: #1565c0;
    }
    ul, ol {
      padding-left: 1.4em;
      margin-bottom: 1em;
    }
    li {
      margin-bottom: 0.4em;
    }
    strong {
      color: #0d47a1;
    }
    code, pre {
      background: #e3f2fd;
      color: #0d47a1;
      border-radius: 6px;
      padding: 0.2em 0.5em;
      font-family: 'Fira Mono', 'Consolas', 'Menlo', monospace;
      font-size: 1em;
    }
    pre {
      padding: 1em;
      overflow-x: auto;
      margin: 1em 0;
      background: #e3f0ff;
      border-left: 4px solid #1976d2;
    }
    .sourceCode {
      background: #e3f0ff !important;
      border-left: 4px solid #1976d2;
      padding: 1em;
      border-radius: 8px;
      margin: 1em 0;
      overflow-x: auto;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: #fafcff;
      margin: 1.5em 0;
    }
    th, td {
      border: 1px solid #bbdefb;
      padding: 0.6em 1em;
      text-align: left;
    }
    th {
      background: #90caf9;
      color: #0d47a1;
    }
    tr:nth-child(even) {
      background: #e3f2fd;
    }
    blockquote {
      border-left: 5px solid #2196f3;
      margin: 1.5em 0;
      padding: 0.8em 1.2em;
      background: #f1f8ff;
      color: #1565c0;
      border-radius: 8px;
    }
    @media (max-width: 600px) {
      .container {
        padding: 12px 2vw;
      }
      pre, .sourceCode {
        font-size: 0.9em;
        padding: 0.5em;
      }
    }
  </style>
</head>
<body>
<div class="container">
<h1 id="iimk-professional-certificate-in-data-science-and-ai-for-managers">🎓 IIMK Professional Certificate in Data Science and AI for Managers</h1>
<h2
id="assignment-9.1-advanced-income-prediction-with-feature-engineering">📊
Assignment 9.1: Advanced Income Prediction with Feature Engineering</h2>
<h3 id="student-information">👨‍🎓 Student Information:</h3>
<ul>
<li><strong>Name:</strong> Lalit Nayyar</li>
<li><strong>Email:</strong> lalitnayyar@gmail.com</li>
<li><strong>Course:</strong> Professional Certificate in Data Science
and Artificial Intelligence for Managers</li>
<li><strong>Institution:</strong> Indian Institute of Management
Kozhikode (IIMK)</li>
<li><strong>Submission Date:</strong> June 5, 2025</li>
</ul>
<h2 id="assignment-overview">🌟 Assignment Overview</h2>
<p>This project showcases advanced machine learning techniques for
income prediction using the Adult Income Dataset. The implementation
focuses on sophisticated feature engineering, model development, and
comprehensive analysis.</p>
<h3 id="key-objectives">🎯 Key Objectives</h3>
<ol type="1">
<li>🔍 Implement advanced feature engineering techniques</li>
<li>📊 Develop robust classification models</li>
<li>📈 Analyze model performance with multiple metrics</li>
<li>📝 Create a professional data science report</li>
</ol>
<h2 id="assignment-overview-1">📋 Assignment Overview</h2>
<p>🔍 This project implements supervised learning techniques to predict
income levels using the Adult Income Dataset. The assignment focuses on
understanding classification models, their performance metrics, and data
preprocessing techniques.</p>
<h3 id="learning-objectives">🎯 Learning Objectives</h3>
<ol type="1">
<li>📚 Detail the Supervised Learning process</li>
<li>📈 Evaluate classifiers based on specific performance metrics</li>
<li>🤖 Perform comprehensive data preprocessing and feature
engineering</li>
<li>📊 Create a professional data science report</li>
</ol>
<h2 id="user-guide">📖 User Guide</h2>
<h3 id="quick-start">🚀 Quick Start</h3>
<ol type="1">
<li><strong>Environment Setup</strong></li>
</ol>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> venv venv</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span><span class="dt">\v</span>env<span class="dt">\S</span>cripts<span class="dt">\a</span>ctivate  <span class="co"># Windows</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code></pre></div>
<ol start="2" type="1">
<li><strong>Launch Notebook</strong></li>
</ol>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jupyter</span> notebook lalitnayyar_assignment9.ipynb</span></code></pre></div>
<h3 id="notebook-navigation">📓 Notebook Navigation</h3>
<ol type="1">
<li>📥 <strong>Data Loading &amp; Exploration</strong>
<ul>
<li>Dataset overview</li>
<li>Initial statistics</li>
<li>Data quality checks</li>
</ul></li>
<li>⚡ <strong>Feature Engineering</strong>
<ul>
<li>Age grouping</li>
<li>Income ratios calculation</li>
<li>Work-life balance indicators</li>
<li>Feature distribution analysis</li>
</ul></li>
<li>🤖 <strong>Model Development</strong>
<ul>
<li>Data preprocessing</li>
<li>Model training</li>
<li>Performance evaluation</li>
</ul></li>
<li>📊 <strong>Results &amp; Analysis</strong>
<ul>
<li>Visualization of results</li>
<li>Performance metrics</li>
<li>Feature importance analysis</li>
</ul></li>
</ol>
<h2 id="project-structure-code-organization">📁 Project Structure &amp;
Code Organization</h2>
<h3 id="core-files">📌 Core Files</h3>
<ul>
<li>📔 <code>lalitnayyar_assignment9.ipynb</code>: Main submission
notebook</li>
<li>🛠️ <code>feature_engineering.py</code>: Custom feature engineering
module</li>
<li>📊 <code>data_loader.py</code>: Data handling utilities</li>
<li>📝 <code>requirements.txt</code>: Project dependencies</li>
<li>📘 <code>README.md</code>: Project documentation</li>
</ul>
<h3 id="supporting-modules">🔧 Supporting Modules</h3>
<ol type="1">
<li><strong>Feature Engineering Module</strong>
(<code>feature_engineering.py</code>)
<ul>
<li><code>create_age_groups()</code>: Age categorization</li>
<li><code>create_income_ratios()</code>: Financial feature creation</li>
<li><code>create_work_life_indicators()</code>: Work pattern
analysis</li>
<li><code>plot_feature_distributions()</code>: Visualization
functions</li>
</ul></li>
<li><strong>Data Loading Module</strong> (<code>data_loader.py</code>)
<ul>
<li>Dataset download functionality</li>
<li>Initial preprocessing</li>
<li>Data validation checks</li>
</ul></li>
</ol>
<h3 id="core-files-1">Core Files</h3>
<ul>
<li>📓 <code>submission_notebook.ipynb</code>: Main Jupyter notebook
containing the complete analysis and report</li>
<li>📝 <code>requirements.txt</code>: List of Python dependencies</li>
<li>📘 <code>README.md</code>: Project documentation</li>
</ul>
<h3 id="notebook-sections">Notebook Sections</h3>
<ol type="1">
<li><strong>Data Preprocessing</strong> 🔄
<ul>
<li>Dataset loading and initial exploration</li>
<li>Missing value analysis and handling</li>
<li>Exploratory Data Analysis (EDA)</li>
</ul></li>
<li><strong>Data Encoding</strong> 🔢
<ul>
<li>Categorical variable conversion</li>
<li>Label and One-hot encoding implementation</li>
<li>Data interpretability preservation</li>
</ul></li>
<li><strong>Feature Selection and Engineering</strong> 🔍
<ul>
<li>Correlation analysis</li>
<li>Feature importance evaluation</li>
<li>New feature creation</li>
</ul></li>
</ol>
<h2 id="technical-requirements-setup">🛠️ Technical Requirements &amp;
Setup</h2>
<h3 id="system-requirements">💻 System Requirements</h3>
<ul>
<li>🐍 Python 3.8+</li>
<li>🧮 8GB RAM recommended</li>
<li>💾 2GB free disk space</li>
<li>📊 Jupyter Notebook environment</li>
</ul>
<h3 id="key-dependencies">📦 Key Dependencies</h3>
<pre><code>pandas&gt;=1.3.0
numpy&gt;=1.20.0
scikit-learn&gt;=0.24.0
matplotlib&gt;=3.4.0
seaborn&gt;=0.11.0
jupyter&gt;=1.0.0</code></pre>
<h3 id="configuration">⚙️ Configuration</h3>
<ul>
<li>All paths are relative to project root</li>
<li>Data is automatically downloaded</li>
<li>Visualizations are saved in project directory</li>
</ul>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li>Python &gt;= 3.8</li>
<li>pandas &gt;= 1.3.0</li>
<li>numpy &gt;= 1.20.0</li>
<li>matplotlib &gt;= 3.4.0</li>
<li>seaborn &gt;= 0.11.0</li>
<li>scikit-learn &gt;= 0.24.0</li>
<li>jupyter &gt;= 1.0.0</li>
</ul>
<h3 id="dataset">Dataset</h3>
<p>The Adult Income Dataset is automatically downloaded from the UCI
Machine Learning Repository when running the notebook. No manual
download is required.</p>
<h2 id="notebook-structure-documentation">📊 Notebook Structure &amp;
Documentation</h2>
<h3 id="main-sections">📑 Main Sections</h3>
<ol type="1">
<li><strong>📋 Introduction &amp; Setup</strong>
<ul>
<li>Project overview</li>
<li>Library imports</li>
<li>Configuration setup</li>
</ul></li>
<li><strong>🔍 Data Exploration</strong>
<ul>
<li>Dataset characteristics</li>
<li>Statistical analysis</li>
<li>Data quality assessment</li>
</ul></li>
<li><strong>⚡ Feature Engineering</strong>
<ul>
<li>Age-based features</li>
<li>Income ratio calculations</li>
<li>Work pattern indicators</li>
<li>Distribution analysis</li>
</ul></li>
<li><strong>🤖 Model Development</strong>
<ul>
<li>Data preprocessing</li>
<li>Model selection</li>
<li>Training pipeline</li>
<li>Hyperparameter tuning</li>
</ul></li>
<li><strong>📈 Results &amp; Analysis</strong>
<ul>
<li>Performance metrics</li>
<li>Feature importance</li>
<li>Visual analysis</li>
<li>Conclusions</li>
</ul></li>
</ol>
<h3 id="documentation-standards">📝 Documentation Standards</h3>
<ul>
<li>Detailed markdown explanations</li>
<li>Code comments</li>
<li>Visual result interpretation</li>
<li>Implementation justifications</li>
</ul>
<p>The notebook is structured as a professional data science report
with: 1. Clear section headers and documentation 2. Detailed
explanations and justifications 3. Visualizations and statistical
analysis 4. Code comments and implementation details</p>
<h2 id="key-features">🔍 Key Features</h2>
<ul>
<li>Comprehensive data preprocessing pipeline</li>
<li>Advanced feature engineering techniques</li>
<li>Detailed correlation analysis</li>
<li>Professional report formatting</li>
<li>Reproducible code structure</li>
</ul>
<h3 id="system-requirements-1">💻 System Requirements</h3>
<ul>
<li>🐍 Python 3.8 or higher</li>
<li>📔 Jupyter Notebook</li>
<li>🧮 4GB RAM minimum</li>
<li>💾 1GB free disk space</li>
</ul>
<h3 id="installation-steps">🔧 Installation Steps</h3>
<ol type="1">
<li><p>Clone or download this repository</p></li>
<li><p>Create a virtual environment (recommended):</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> venv venv</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span><span class="dt">\v</span>env<span class="dt">\S</span>cripts<span class="dt">\a</span>ctivate  <span class="co"># On Windows</span></span></code></pre></div></li>
<li><p>Install dependencies</p></li>
<li><p>Run the data download script</p></li>
<li><p>Launch Jupyter Notebook</p></li>
</ol>
<h3 id="troubleshooting">⚠️ Troubleshooting</h3>
<ul>
<li>🔍 If the automatic data download fails, use the manual Kaggle
download option</li>
<li>🔄 For package conflicts, try creating a fresh virtual
environment</li>
<li>✅ Check Python version compatibility if encountering errors</li>
</ul>
<h2 id="technical-details">🔬 Technical Details</h2>
<h3 id="data-processing-pipeline">🔄 Data Processing Pipeline</h3>
<ol type="1">
<li>📥 Data acquisition from UCI repository</li>
<li>🧹 Preprocessing and cleaning</li>
<li>⚡ Feature engineering</li>
<li>🎯 Model training and evaluation</li>
</ol>
<h3 id="models-implemented">🤖 Models Implemented</h3>
<ol type="1">
<li>Support Vector Machine (SVM)
<ul>
<li>Kernel: RBF</li>
<li>Standardized features</li>
<li>Cross-validation</li>
</ul></li>
<li>Naïve Bayes
<ul>
<li>Gaussian NB implementation</li>
<li>Probability-based classification</li>
</ul></li>
</ol>
<h3 id="performance-metrics">📊 Performance Metrics</h3>
<ul>
<li>🎯 Accuracy</li>
<li>📈 Precision</li>
<li>📉 Recall</li>
<li>⭐ F1-Score</li>
<li>🔄 Confusion Matrix</li>
</ul>
<h2 id="assignment-submission-guidelines">📝 Assignment Submission
Guidelines</h2>
<h3 id="submission-components">🎯 Submission Components</h3>
<ol type="1">
<li><strong>Main Notebook</strong>
(<code>lalitnayyar_assignment9.ipynb</code>)
<ul>
<li>✅ All cells executed in order</li>
<li>✅ Output cells preserved</li>
<li>✅ Visualizations properly rendered</li>
<li>✅ Markdown documentation complete</li>
</ul></li>
<li><strong>Supporting Files</strong>
<ul>
<li>✅ <code>feature_engineering.py</code></li>
<li>✅ <code>data_loader.py</code></li>
<li>✅ <code>requirements.txt</code></li>
<li>✅ Generated visualizations</li>
</ul></li>
</ol>
<h3 id="quality-checklist">🔍 Quality Checklist</h3>
<ul>
<li>✓ Code follows PEP 8 standards</li>
<li>✓ All visualizations are properly labeled</li>
<li>✓ Results are thoroughly explained</li>
<li>✓ Feature engineering steps documented</li>
<li>✓ Performance metrics analyzed</li>
</ul>
<h3 id="submission-process">📤 Submission Process</h3>
<ol type="1">
<li>Verify all cells are executed</li>
<li>Ensure all outputs are saved</li>
<li>Check visualization quality</li>
<li>Validate documentation completeness</li>
<li>Submit complete project folder</li>
</ol>
<h2 id="support-contact">🤝 Support &amp; Contact</h2>
<p>For any queries regarding this submission: - 📧 Email:
lalitnayyar@gmail.com - 🎓 Course: IIMK Professional Certificate in Data
Science - 📅 Batch: 2025 1. Complete all notebook cells 2. Ensure all
visualizations are properly rendered 3. Include analysis and
interpretations 4. Submit the entire project folder</p>
<h2 id="detailed-code-description">Detailed Code Description</h2>
<h3 id="data-download-module-download_data.py">1. Data Download Module
(<code>download_data.py</code>)</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_adult_dataset():</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Downloads data from UCI repository</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Processes and combines train/test data</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Saves to data/adult.csv</span></span></code></pre></div>
<ul>
<li>Handles automatic data download from UCI repository</li>
<li>Processes both training and test datasets</li>
<li>Performs initial data cleaning</li>
<li>Creates unified CSV file</li>
</ul>
<h3 id="main-notebook-components-income_prediction.ipynb">2. Main
Notebook Components (<code>income_prediction.ipynb</code>)</h3>
<h4 id="data-preprocessing">Data Preprocessing</h4>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_data(df):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handles missing values</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Encodes categorical variables</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scales numerical features</span></span></code></pre></div>
<ul>
<li>Missing value imputation</li>
<li>Categorical variable encoding</li>
<li>Feature scaling</li>
<li>Data type conversions</li>
</ul>
<h4 id="feature-engineering">Feature Engineering</h4>
<ul>
<li>Creation of derived features</li>
<li>One-hot encoding for categorical variables</li>
<li>Feature selection based on correlation analysis</li>
<li>Handling of outliers</li>
</ul>
<h4 id="model-implementation">Model Implementation</h4>
<ol type="1">
<li><strong>SVM Classifier</strong></li>
</ol>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>svm_classifier <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">&#39;rbf&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
<ul>
<li>RBF kernel implementation</li>
<li>Hyperparameter tuning</li>
<li>Cross-validation setup</li>
</ul>
<ol start="2" type="1">
<li><strong>Naïve Bayes Classifier</strong></li>
</ol>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>nb_classifier <span class="op">=</span> GaussianNB()</span></code></pre></div>
<ul>
<li>Gaussian probability distribution</li>
<li>Prior probability calculation</li>
<li>Feature independence assumption</li>
</ul>
<h4 id="performance-evaluation">Performance Evaluation</h4>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_model(y_true, y_pred):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculates accuracy, precision, recall</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generates confusion matrix</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Creates visualization plots</span></span></code></pre></div>
<ul>
<li>Comprehensive metrics calculation</li>
<li>Visual performance analysis</li>
<li>Model comparison tools</li>
</ul>
<h3 id="visualization-components">3. Visualization Components</h3>
<ul>
<li>Distribution plots for features</li>
<li>Correlation heatmaps</li>
<li>ROC curves</li>
<li>Confusion matrices</li>
<li>Performance comparison charts</li>
</ul>
<h3 id="helper-functions">4. Helper Functions</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data validation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_data(df):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Checks data integrity</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validates data types</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensures consistent formatting</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_feature_importance(model, X):</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculates feature importance</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ranks features by impact</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Visualizes importance scores</span></span></code></pre></div>
<h2 id="version-information">Version Information</h2>
<p>v1.0.0 - Initial release for IIMK Assignment 9.1 # 🎓 IIMK
Professional Certificate in Data Science and AI for Managers</p>
<h2 id="assignment-9.1-supervised-learning-and-classification-models">📊
Assignment 9.1: Supervised Learning and Classification Models</h2>
<h3 id="student-information-1">👨‍🎓 Student Information:</h3>
<ul>
<li><strong>Name:</strong> Lalit Nayyar</li>
<li><strong>Email:</strong> lalitnayyar@gmail.com</li>
<li><strong>Course:</strong> Professional Certificate in Data Science
and Artificial Intelligence for Managers</li>
<li><strong>Institution:</strong> Indian Institute of Management
Kozhikode (IIMK)</li>
</ul>
<h2 id="assignment-overview-2">📋 Assignment Overview</h2>
<p>🔍 This project implements supervised learning techniques to predict
income levels using the Adult Income Dataset. The assignment focuses on
understanding classification models, their performance metrics, and data
preprocessing techniques.</p>
<h3 id="dataset-description">Dataset Description</h3>
<p>The Adult Income Dataset, also known as the Census Income dataset,
contains demographic and employment-related features to predict whether
an individual’s annual income exceeds $50,000. This real-world dataset
presents various data preprocessing and modeling challenges that are
common in practical machine learning applications.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import necessary libraries</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure visualization settings</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&#39;default&#39;</span>)  <span class="co"># Use default matplotlib style</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>sns.set_theme()  <span class="co"># Set seaborn theme</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre></div>
<h2 id="data-preprocessing-1">1. Data Preprocessing 🔄</h2>
<h3 id="a.-loading-the-dataset">1.a. Loading the Dataset</h3>
<p>We begin by loading the Adult Income dataset. This dataset contains
various demographic and employment-related features such as age,
education, occupation, and other socio-economic factors that might
influence an individual’s income level.</p>
<p>The dataset features include: - Numerical attributes: age, fnlwgt,
education-num, capital-gain, capital-loss, hours-per-week - Categorical
attributes: workclass, education, marital-status, occupation,
relationship, race, sex, native-country</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define column names</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;age&#39;</span>, <span class="st">&#39;workclass&#39;</span>, <span class="st">&#39;fnlwgt&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;education-num&#39;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;marital-status&#39;</span>, <span class="st">&#39;occupation&#39;</span>, <span class="st">&#39;relationship&#39;</span>, <span class="st">&#39;race&#39;</span>, <span class="st">&#39;sex&#39;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;capital-gain&#39;</span>, <span class="st">&#39;capital-loss&#39;</span>, <span class="st">&#39;hours-per-week&#39;</span>, <span class="st">&#39;native-country&#39;</span>, <span class="st">&#39;income&#39;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data&#39;</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                 names<span class="op">=</span>columns, skipinitialspace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows and basic information</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dataset Shape:&quot;</span>, df.shape)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">First few rows of the dataset:&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre><code>Dataset Shape: (32561, 15)

First few rows of the dataset:</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
age
</th>
<th>
workclass
</th>
<th>
fnlwgt
</th>
<th>
education
</th>
<th>
education-num
</th>
<th>
marital-status
</th>
<th>
occupation
</th>
<th>
relationship
</th>
<th>
race
</th>
<th>
sex
</th>
<th>
capital-gain
</th>
<th>
capital-loss
</th>
<th>
hours-per-week
</th>
<th>
native-country
</th>
<th>
income
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
39
</td>
<td>
State-gov
</td>
<td>
77516
</td>
<td>
Bachelors
</td>
<td>
13
</td>
<td>
Never-married
</td>
<td>
Adm-clerical
</td>
<td>
Not-in-family
</td>
<td>
White
</td>
<td>
Male
</td>
<td>
2174
</td>
<td>
0
</td>
<td>
40
</td>
<td>
United-States
</td>
<td>
&lt;=50K
</td>
</tr>
<tr>
<th>
1
</th>
<td>
50
</td>
<td>
Self-emp-not-inc
</td>
<td>
83311
</td>
<td>
Bachelors
</td>
<td>
13
</td>
<td>
Married-civ-spouse
</td>
<td>
Exec-managerial
</td>
<td>
Husband
</td>
<td>
White
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
0
</td>
<td>
13
</td>
<td>
United-States
</td>
<td>
&lt;=50K
</td>
</tr>
<tr>
<th>
2
</th>
<td>
38
</td>
<td>
Private
</td>
<td>
215646
</td>
<td>
HS-grad
</td>
<td>
9
</td>
<td>
Divorced
</td>
<td>
Handlers-cleaners
</td>
<td>
Not-in-family
</td>
<td>
White
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
United-States
</td>
<td>
&lt;=50K
</td>
</tr>
<tr>
<th>
3
</th>
<td>
53
</td>
<td>
Private
</td>
<td>
234721
</td>
<td>
11th
</td>
<td>
7
</td>
<td>
Married-civ-spouse
</td>
<td>
Handlers-cleaners
</td>
<td>
Husband
</td>
<td>
Black
</td>
<td>
Male
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
United-States
</td>
<td>
&lt;=50K
</td>
</tr>
<tr>
<th>
4
</th>
<td>
28
</td>
<td>
Private
</td>
<td>
338409
</td>
<td>
Bachelors
</td>
<td>
13
</td>
<td>
Married-civ-spouse
</td>
<td>
Prof-specialty
</td>
<td>
Wife
</td>
<td>
Black
</td>
<td>
Female
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
Cuba
</td>
<td>
&lt;=50K
</td>
</tr>
</tbody>
</table>
</div>
<h3 id="b.-exploratory-data-analysis-eda">1.b. Exploratory Data Analysis
(EDA)</h3>
<p>Let’s perform a comprehensive analysis of our dataset to understand:
- Data types of each feature - Missing values - Basic statistics of
numerical columns - Distribution of categorical variables</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display basic information about the dataset</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dataset Info:&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Missing Values:&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Numerical Columns Statistics:&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span></code></pre></div>
<pre><code>Dataset Info:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 32561 entries, 0 to 32560
Data columns (total 15 columns):
 #   Column          Non-Null Count  Dtype 
---  ------          --------------  ----- 
 0   age             32561 non-null  int64 
 1   workclass       32561 non-null  object
 2   fnlwgt          32561 non-null  int64 
 3   education       32561 non-null  object
 4   education-num   32561 non-null  int64 
 5   marital-status  32561 non-null  object
 6   occupation      32561 non-null  object
 7   relationship    32561 non-null  object
 8   race            32561 non-null  object
 9   sex             32561 non-null  object
 10  capital-gain    32561 non-null  int64 
 11  capital-loss    32561 non-null  int64 
 12  hours-per-week  32561 non-null  int64 
 13  native-country  32561 non-null  object
 14  income          32561 non-null  object
dtypes: int64(6), object(9)
memory usage: 3.7+ MB

Missing Values:
age               0
workclass         0
fnlwgt            0
education         0
education-num     0
marital-status    0
occupation        0
relationship      0
race              0
sex               0
capital-gain      0
capital-loss      0
hours-per-week    0
native-country    0
income            0
dtype: int64

Numerical Columns Statistics:
                age        fnlwgt  education-num  capital-gain  capital-loss  \
count  32561.000000  3.256100e+04   32561.000000  32561.000000  32561.000000   
mean      38.581647  1.897784e+05      10.080679   1077.648844     87.303830   
std       13.640433  1.055500e+05       2.572720   7385.292085    402.960219   
min       17.000000  1.228500e+04       1.000000      0.000000      0.000000   
25%       28.000000  1.178270e+05       9.000000      0.000000      0.000000   
50%       37.000000  1.783560e+05      10.000000      0.000000      0.000000   
75%       48.000000  2.370510e+05      12.000000      0.000000      0.000000   
max       90.000000  1.484705e+06      16.000000  99999.000000   4356.000000   

       hours-per-week  
count    32561.000000  
mean        40.437456  
std         12.347429  
min          1.000000  
25%         40.000000  
50%         40.000000  
75%         45.000000  
max         99.000000  </code></pre>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze categorical variables</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Unique values in </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df[col].value_counts(normalize<span class="op">=</span><span class="va">True</span>).head())</span></code></pre></div>
<pre><code>Unique values in workclass:
workclass
Private             0.697030
Self-emp-not-inc    0.078038
Local-gov           0.064279
?                   0.056386
State-gov           0.039864
Name: proportion, dtype: float64

Unique values in education:
education
HS-grad         0.322502
Some-college    0.223918
Bachelors       0.164461
Masters         0.052916
Assoc-voc       0.042443
Name: proportion, dtype: float64

Unique values in marital-status:
marital-status
Married-civ-spouse    0.459937
Never-married         0.328092
Divorced              0.136452
Separated             0.031479
Widowed               0.030497
Name: proportion, dtype: float64

Unique values in occupation:
occupation
Prof-specialty     0.127146
Craft-repair       0.125887
Exec-managerial    0.124873
Adm-clerical       0.115783
Sales              0.112097
Name: proportion, dtype: float64

Unique values in relationship:
relationship
Husband          0.405178
Not-in-family    0.255060
Own-child        0.155646
Unmarried        0.105832
Wife             0.048156
Name: proportion, dtype: float64

Unique values in race:
race
White                 0.854274
Black                 0.095943
Asian-Pac-Islander    0.031909
Amer-Indian-Eskimo    0.009551
Other                 0.008323
Name: proportion, dtype: float64

Unique values in sex:
sex
Male      0.669205
Female    0.330795
Name: proportion, dtype: float64

Unique values in native-country:
native-country
United-States    0.895857
Mexico           0.019748
?                0.017905
Philippines      0.006081
Germany          0.004207
Name: proportion, dtype: float64

Unique values in income:
income
&lt;=50K    0.75919
&gt;50K     0.24081
Name: proportion, dtype: float64</code></pre>
<h3 id="c.-handling-missing-and-erroneous-data">1.c. Handling Missing
and Erroneous Data</h3>
<p>In this dataset, missing values are denoted by ‘?’ rather than
standard NULL or NaN values. We need to: 1. Identify these non-standard
missing values 2. Replace them with appropriate values 3. Document our
approach and rationale</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace &#39;?&#39; with NaN to properly handle missing values</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.replace(<span class="st">&#39;?&#39;</span>, np.nan)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display missing value count after replacement</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Missing values after replacement:&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing values using mode imputation</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> df.columns:</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df[column].isnull().<span class="bu">any</span>():</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Using the recommended approach to avoid the warning</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        df.loc[:, column] <span class="op">=</span> df[column].fillna(df[column].mode()[<span class="dv">0</span>])</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Verifying no missing values remain:&quot;</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>())</span></code></pre></div>
<pre><code>Missing values after replacement:
age                  0
workclass         1836
fnlwgt               0
education            0
education-num        0
marital-status       0
occupation        1843
relationship         0
race                 0
sex                  0
capital-gain         0
capital-loss         0
hours-per-week       0
native-country     583
income               0
dtype: int64

Verifying no missing values remain:
0</code></pre>
<h2 id="data-encoding">2. Data Encoding 🔢</h2>
<h3 id="a.-converting-categorical-variables">2.a. Converting Categorical
Variables</h3>
<p>We’ll use Label Encoding for ordinal categorical variables and
One-Hot Encoding for nominal categorical variables to preserve their
interpretability.</p>
<p><strong>Rationale for encoding choices:</strong> - Label Encoding:
Used for ordinal variables like ‘education’ where there’s a natural
order - One-Hot Encoding: Used for nominal variables like ‘workclass’
where there’s no inherent order</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify categorical columns for encoding</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ordinal_columns <span class="op">=</span> [<span class="st">&#39;education&#39;</span>]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>nominal_columns <span class="op">=</span> [<span class="st">&#39;workclass&#39;</span>, <span class="st">&#39;marital-status&#39;</span>, <span class="st">&#39;occupation&#39;</span>, <span class="st">&#39;relationship&#39;</span>, <span class="st">&#39;race&#39;</span>, <span class="st">&#39;sex&#39;</span>, <span class="st">&#39;native-country&#39;</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Label Encoding for ordinal variables</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> ordinal_columns:</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    label_encoders[column] <span class="op">=</span> LabelEncoder()</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    df[column] <span class="op">=</span> label_encoders[column].fit_transform(df[column])</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># One-Hot Encoding for nominal variables</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>nominal_columns, prefix<span class="op">=</span>nominal_columns)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dataset shape after encoding:&quot;</span>, df.shape)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">First few columns:&quot;</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre><code>Dataset shape after encoding: (32561, 91)

First few columns:</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
age
</th>
<th>
fnlwgt
</th>
<th>
education
</th>
<th>
education-num
</th>
<th>
capital-gain
</th>
<th>
capital-loss
</th>
<th>
hours-per-week
</th>
<th>
income
</th>
<th>
workclass_Federal-gov
</th>
<th>
workclass_Local-gov
</th>
<th>
…
</th>
<th>
native-country_Portugal
</th>
<th>
native-country_Puerto-Rico
</th>
<th>
native-country_Scotland
</th>
<th>
native-country_South
</th>
<th>
native-country_Taiwan
</th>
<th>
native-country_Thailand
</th>
<th>
native-country_Trinadad&amp;Tobago
</th>
<th>
native-country_United-States
</th>
<th>
native-country_Vietnam
</th>
<th>
native-country_Yugoslavia
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
39
</td>
<td>
77516
</td>
<td>
9
</td>
<td>
13
</td>
<td>
2174
</td>
<td>
0
</td>
<td>
40
</td>
<td>
&lt;=50K
</td>
<td>
False
</td>
<td>
False
</td>
<td>
…
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
True
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
1
</th>
<td>
50
</td>
<td>
83311
</td>
<td>
9
</td>
<td>
13
</td>
<td>
0
</td>
<td>
0
</td>
<td>
13
</td>
<td>
&lt;=50K
</td>
<td>
False
</td>
<td>
False
</td>
<td>
…
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
True
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
2
</th>
<td>
38
</td>
<td>
215646
</td>
<td>
11
</td>
<td>
9
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
&lt;=50K
</td>
<td>
False
</td>
<td>
False
</td>
<td>
…
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
True
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
3
</th>
<td>
53
</td>
<td>
234721
</td>
<td>
1
</td>
<td>
7
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
&lt;=50K
</td>
<td>
False
</td>
<td>
False
</td>
<td>
…
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
True
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
<tr>
<th>
4
</th>
<td>
28
</td>
<td>
338409
</td>
<td>
9
</td>
<td>
13
</td>
<td>
0
</td>
<td>
0
</td>
<td>
40
</td>
<td>
&lt;=50K
</td>
<td>
False
</td>
<td>
False
</td>
<td>
…
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
<td>
False
</td>
</tr>
</tbody>
</table>
<p>
5 rows × 91 columns
</p>
</div>
<h2 id="feature-selection-and-engineering">3. Feature Selection and
Engineering 🔍</h2>
<h3 id="a.-correlation-analysis">3.a. Correlation Analysis</h3>
<p>We’ll analyze feature relationships and importance through
correlation analysis, focusing on: 1. Correlation between numerical
features 2. Identifying potential multicollinearity 3. Feature
importance relative to our target variable (income)</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix for numerical features</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>numerical_columns <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df[numerical_columns].corr()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create correlation heatmap</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, center<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Heatmap of Numerical Features&#39;</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<figure>
<img
src="lalitnayyar_assignment9_md_files/lalitnayyar_assignment9_md_13_0.png"
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h3 id="b.-feature-engineering">3.b. Feature Engineering</h3>
<p>Based on our analysis and domain knowledge, we’ll create new features
that might enhance model performance: 1. Age groups (binning age into
meaningful categories) 2. Income-related ratios 3. Work-life balance
indicators</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;age_group&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;age&#39;</span>], </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                        bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">100</span>],</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                        labels<span class="op">=</span>[<span class="st">&#39;Young&#39;</span>, <span class="st">&#39;Early-Career&#39;</span>, <span class="st">&#39;Mid-Career&#39;</span>, <span class="st">&#39;Late-Career&#39;</span>, <span class="st">&#39;Pre-Retirement&#39;</span>, <span class="st">&#39;Retirement&#39;</span>])</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create work-life balance indicator</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;work_intensity&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;hours-per-week&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39;High&#39;</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">40</span> <span class="cf">else</span> <span class="st">&#39;Normal&#39;</span> <span class="cf">if</span> x <span class="op">&gt;=</span> <span class="dv">35</span> <span class="cf">else</span> <span class="st">&#39;Part-time&#39;</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create capital utilization ratio</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;capital_utilization&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;capital-gain&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;capital-loss&#39;</span>]) <span class="op">/</span> (df[<span class="st">&#39;capital-gain&#39;</span>] <span class="op">+</span> df[<span class="st">&#39;capital-loss&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot encode the new categorical features</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">&#39;age_group&#39;</span>, <span class="st">&#39;work_intensity&#39;</span>])</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Final dataset shape:&quot;</span>, df.shape)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">New features:&quot;</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>new_features <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> col.startswith((<span class="st">&#39;age_group_&#39;</span>, <span class="st">&#39;work_intensity_&#39;</span>, <span class="st">&#39;capital_utilization&#39;</span>))]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_features)</span></code></pre></div>
<pre><code>Final dataset shape: (32561, 101)

New features:
[&#39;capital_utilization&#39;, &#39;age_group_Young&#39;, &#39;age_group_Early-Career&#39;, &#39;age_group_Mid-Career&#39;, &#39;age_group_Late-Career&#39;, &#39;age_group_Pre-Retirement&#39;, &#39;age_group_Retirement&#39;, &#39;work_intensity_High&#39;, &#39;work_intensity_Normal&#39;, &#39;work_intensity_Part-time&#39;]</code></pre>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import our feature engineering module</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> feature_engineering <span class="im">import</span> (</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    create_age_groups, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    create_income_ratios, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    create_work_life_indicators, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    plot_feature_distributions</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply feature engineering transformations</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Creating new features...&quot;</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> create_age_groups(df)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> create_income_ratios(df)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> create_work_life_indicators(df)</span></code></pre></div>
<pre><code>Creating new features...</code></pre>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display information about new features</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">New features added:&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Age Groups:&quot;</span>, df[<span class="st">&#39;age_group&#39;</span>].unique())</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Work-Life Balance Indicators:&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">&#39;standard_work_week&#39;</span>, <span class="st">&#39;overwork&#39;</span>, <span class="st">&#39;part_time&#39;</span>]:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> df[col].<span class="bu">sum</span>()</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    percentage <span class="op">=</span> (count <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;- </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">:,}</span><span class="ss"> instances (</span><span class="sc">{</span>percentage<span class="sc">:.1f}</span><span class="ss">%)&quot;</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<pre><code>New features added:
Age Groups: [&#39;36-45&#39;, &#39;46-55&#39;, &#39;26-35&#39;, &#39;18-25&#39;, &#39;56-65&#39;, &#39;65+&#39;]
Categories (6, object): [&#39;18-25&#39; &lt; &#39;26-35&#39; &lt; &#39;36-45&#39; &lt; &#39;46-55&#39; &lt; &#39;56-65&#39; &lt; &#39;65+&#39;]

Work-Life Balance Indicators:
- standard_work_week: 15,217 instances (46.7%)
- overwork: 7,139 instances (21.9%)
- part_time: 5,583 instances (17.1%)</code></pre>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the distributions</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_feature_distributions(df)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<pre><code>&lt;Figure size 1500x1000 with 0 Axes&gt;</code></pre>
<figure>
<img
src="lalitnayyar_assignment9_md_files/lalitnayyar_assignment9_md_18_1.png"
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Brief analysis of engineered features</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Feature Analysis:&quot;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;1. Age Distribution:&quot;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>age_income <span class="op">=</span> pd.crosstab(df[<span class="st">&#39;age_group&#39;</span>], df[<span class="st">&#39;income&#39;</span>], normalize<span class="op">=</span><span class="st">&#39;index&#39;</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(age_income.<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">2. Work Pattern Analysis:&quot;</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>work_income <span class="op">=</span> pd.DataFrame({</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Standard Work Week&#39;</span>: df[df[<span class="st">&#39;standard_work_week&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;income&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Overwork&#39;</span>: df[df[<span class="st">&#39;overwork&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;income&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Part Time&#39;</span>: df[df[<span class="st">&#39;part_time&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;income&#39;</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>}) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(work_income.<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<pre><code>Feature Analysis:
1. Age Distribution:
income     &lt;=50K   &gt;50K
age_group              
18-25      98.90   1.10
26-35      83.17  16.83
36-45      66.84  33.16
46-55      59.88  40.12
56-65      67.65  32.35
65+        79.34  20.66

2. Work Pattern Analysis:
        Standard Work Week  Overwork  Part Time
income                                         
&lt;=50K                78.66     58.24      93.07
&gt;50K                 21.34     41.76       6.93</code></pre>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save engineered features</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Saving dataset with new features...&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">&#39;data/adult_with_features.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Features saved successfully!&quot;</span>)</span></code></pre></div>
<pre><code>Saving dataset with new features...
Features saved successfully!</code></pre>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
